
# 20.7s user time, 60ms system time, 33.04M rss, 39.22M vsz
# Current date: Mon Dec  9 16:43:35 2024
# Hostname: ip-192-168-0-12
# Files: /var/log/mysql/mysql-slow.log
# Overall: 279.07k total, 136 unique, 1.86k QPS, 1.25x concurrency _______
# Time range: 2024-12-09T16:41:04 to 2024-12-09T16:43:34
# Attribute          total     min     max     avg     95%  stddev  median
# ============     ======= ======= ======= ======= ======= ======= =======
# Exec time           187s     2us   500ms   669us     2ms     5ms   144us
# Lock time             2s       0   223ms     5us     1us   544us     1us
# Rows sent        376.55k       0  20.71k    1.38    1.96   40.63    0.99
# Rows examine      11.17M       0  41.42k   41.96   33.28  204.08    0.99
# Query size        23.61M       6 1011.33k   88.70  124.25   2.97k   97.36

# Profile
# Rank Query ID                            Response time Calls R/Call V/M 
# ==== =================================== ============= ===== ====== ====
#    1 0xFFFCA4D67EA0A788813031B8BBC3B329  60.4732 32.3% 46063 0.0013  0.01 COMMIT
#    2 0x172F25C01059578EA9ADF775DD97B517  45.5935 24.4%   719 0.0634  0.04 SELECT ride_statuses rides ride_statuses
#    3 0xDCA6B16A0FC65C799EB401CBD984EACF  12.0023  6.4% 41139 0.0003  0.00 SELECT ride_statuses
#    4 0x49D4717E21912CD8B13961B8248A27CF  11.9041  6.4% 40006 0.0003  0.00 SELECT chairs
#    5 0xE13EB9FE8E585FDE0A4C67FEB1D9D015  10.4788  5.6%  4421 0.0024  0.00 SELECT rides
#    6 0xD8DAD8AC6EDE2238F17AC39B0009258F  10.1658  5.4% 39191 0.0003  0.00 SELECT rides
#    7 0xA3B0C1486434871B20F519E77C3FD9E6   6.3187  3.4%  5981 0.0011  0.00 SELECT coupons
#    8 0x9C1BE9A08595D62A208963461F89E6D8   2.5826  1.4%  9448 0.0003  0.00 SELECT ride_statuses
#    9 0xDA53740BFC6EFE80C82E6DACE52D86FD   1.7483  0.9%    91 0.0192  0.03 SELECT rides ride_statuses
#   10 0x81419520B08C9688CC6AB9C44F11C9E6   1.7439  0.9%   164 0.0106  0.01 INSERT payment_tokens
#   11 0xFAB1755BD4E9CE87C5FE1E9D6E43EC40   1.5040  0.8%   722 0.0021  0.00 SELECT rides
#   12 0x5CAA8168B7B8D221E74FB978834E34B2   1.4901  0.8%  4421 0.0003  0.00 SELECT ride_statuses
#   13 0x9E2DA589A20EC24C34E11DDE0FBF5564   1.4557  0.8% 47200 0.0000  0.00 START
#   14 0xDB862F633DEA18D750C8371D2E984DDF   1.4307  0.8%  7150 0.0002  0.01 SELECT users
#   15 0xA8AB6DA329E391A212D0E51BED4B3EDE   1.1766  0.6%   719 0.0016  0.00 SELECT chairs
#   16 0xF25808F84250C9EECEE9DFF5FC25984B   1.1487  0.6%   108 0.0106  0.00 UPDATE chairs
#   17 0x0956F622BA3E7E31F3E1527A61FD7F1E   1.1059  0.6%  1737 0.0006  0.00 SELECT rides ride_statuses
#   18 0xF7AA78CED19E80953A6C54054F4089B2   1.0810  0.6%  2079 0.0005  0.00 UPDATE ride_statuses
#   19 0x780A355BC10F6DC5B57B4BBCC1A9703E   1.0553  0.6%  3251 0.0003  0.00 SELECT ride_statuses
#   20 0xE7AB668DE937457E0A7E2ACD36EEE101   1.0309  0.6%  2068 0.0005  0.01 UPDATE ride_statuses
# MISC 0xMISC                              11.4633  6.1% 22395 0.0005   0.0 <116 ITEMS>

# Query 1: 708.66 QPS, 0.93x concurrency, ID 0xFFFCA4D67EA0A788813031B8BBC3B329 at byte 52756784
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.01
# Time range: 2024-12-09T16:41:22 to 2024-12-09T16:42:27
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count         16   46063
# Exec time     32     60s    15us    56ms     1ms    10ms     3ms    30us
# Lock time      0       0       0       0       0       0       0       0
# Rows sent      0       0       0       0       0       0       0       0
# Rows examine   0       0       0       0       0       0       0       0
# Query size     1 269.90k       6       6       6       6       0       6
# String:
# Databases    isuride
# Hosts        ip-192-168-0-11.ap-northeast-1.compute.inter...
# Users        isucon
# Query_time distribution
#   1us
#  10us  ################################################################
# 100us  #
#   1ms  ######
#  10ms  ###
# 100ms
#    1s
#  10s+
COMMIT\G

# Query 2: 11.98 QPS, 0.76x concurrency, ID 0x172F25C01059578EA9ADF775DD97B517 at byte 74189078
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.04
# Time range: 2024-12-09T16:41:23 to 2024-12-09T16:42:23
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          0     719
# Exec time     24     46s   838us   239ms    63ms   155ms    48ms    46ms
# Lock time      0     5ms     1us     2ms     6us     1us    91us     1us
# Rows sent     26  98.62k       0     388  140.45  346.17  113.95   84.10
# Rows examine   9   1.01M      72   2.63k   1.44k   2.50k  913.71   1.69k
# Query size     5   1.25M     920   3.48k   1.77k   3.19k  872.19   1.39k
# String:
# Databases    isuride
# Hosts        ip-192-168-0-11.ap-northeast-1.compute.inter...
# Users        isucon
# Query_time distribution
#   1us
#  10us
# 100us  #
#   1ms  #
#  10ms  ################################################################
# 100ms  ##################
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isuride` LIKE 'ride_statuses'\G
#    SHOW CREATE TABLE `isuride`.`ride_statuses`\G
#    SHOW TABLE STATUS FROM `isuride` LIKE 'rides'\G
#    SHOW CREATE TABLE `isuride`.`rides`\G
# EXPLAIN /*!50100 PARTITIONS*/
SELECT r.chair_id AS chair_id, rs.status AS status FROM ride_statuses rs LEFT JOIN rides r ON rs.ride_id = r.id INNER JOIN (SELECT ride_id, MAX(created_at) AS max_created_at FROM ride_statuses GROUP BY ride_id) latest_rs ON rs.ride_id = latest_rs.ride_id AND rs.created_at = latest_rs.max_created_at WHERE r.chair_id IN ('01JEP4QZV4CAG39WCWBETHYD99', '01JEP4QZVETDB2JGAD4EG6VGBM', '01JEP4QZVR1FDB78PTKPEY8E0D', '01JEP4QZW4BTYN1111E6CZFHTR', '01JEP4QZXMT80475PV4F7AYDY8', '01JEP4QZXY7MFP12K65R3AYS9H', '01JEP4QZY8CX5D17FEFWC851D4', '01JEP4QZYHR0S37F08PS4TTA00', '01JEP4QZZVW70547BZTDBGQWTP', '01JEP4R00719NGF0QFXETZBG85', '01JEP4R00H14PGECTXD8A1P8X7', '01JEP4R00WMEQH2T0Z3V7E9DF4', '01JEP4R02306YF6JRSCMK2DY5M', '01JEP4R02G9QG3V3VBXSXWZAYC', '01JEP4R02TB0GQ3HBGWVET8WXS', '01JEP4R0348EWGE221RTDS478P', '01JEP4R04AQPCBBAK6H5XXW3W9', '01JEP4R04PGX7RK6YZ5RD63JED', '01JEP4R051YN5JXRXH5XAE2ZNS', '01JEP4R05B42YD2P1B75M655TN'/*... omitted 72 items ...*/)\G

# Query 3: 632.91 QPS, 0.18x concurrency, ID 0xDCA6B16A0FC65C799EB401CBD984EACF at byte 79160743
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.00
# Time range: 2024-12-09T16:41:22 to 2024-12-09T16:42:27
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count         14   41139
# Exec time      6     12s   104us    22ms   291us   761us   652us   167us
# Lock time      3    58ms       0     1ms     1us     1us    13us     1us
# Rows sent     10  40.17k       1       1       1       1       0       1
# Rows examine   0  40.21k       1       5    1.00    0.99    0.04    0.99
# Query size    18   4.32M     110     110     110     110       0     110
# String:
# Databases    isuride
# Hosts        ip-192-168-0-11.ap-northeast-1.compute.inter...
# Users        isucon
# Query_time distribution
#   1us
#  10us
# 100us  ################################################################
#   1ms  ##
#  10ms  #
# 100ms
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isuride` LIKE 'ride_statuses'\G
#    SHOW CREATE TABLE `isuride`.`ride_statuses`\G
# EXPLAIN /*!50100 PARTITIONS*/
SELECT status FROM ride_statuses WHERE ride_id = '01JEP4SMNDVK7GQ71FT57A39XD' ORDER BY created_at DESC LIMIT 1\G

# Query 4: 615.48 QPS, 0.18x concurrency, ID 0x49D4717E21912CD8B13961B8248A27CF at byte 3501598
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.00
# Time range: 2024-12-09T16:41:22 to 2024-12-09T16:42:27
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count         14   40006
# Exec time      6     12s    98us    54ms   297us     1ms   867us   152us
# Lock time      7   118ms       0     4ms     2us     1us    46us     1us
# Rows sent     10  39.07k       1       1       1       1       0       1
# Rows examine   0  39.07k       1       1       1       1       0       1
# Query size    17   4.12M     108     108     108     108       0     108
# String:
# Databases    isuride
# Hosts        ip-192-168-0-11.ap-northeast-1.compute.inter...
# Users        isucon
# Query_time distribution
#   1us
#  10us  #
# 100us  ################################################################
#   1ms  ###
#  10ms  #
# 100ms
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isuride` LIKE 'chairs'\G
#    SHOW CREATE TABLE `isuride`.`chairs`\G
# EXPLAIN /*!50100 PARTITIONS*/
SELECT * FROM chairs WHERE access_token = 'eef0849fac293a0453580ec3a3b70db51a5bd9861676e65163eadf0ca88c38de'\G

# Query 5: 69.08 QPS, 0.16x concurrency, ID 0xE13EB9FE8E585FDE0A4C67FEB1D9D015 at byte 73873527
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.00
# Time range: 2024-12-09T16:41:23 to 2024-12-09T16:42:27
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          1    4421
# Exec time      5     10s   489us    21ms     2ms     7ms     2ms     1ms
# Lock time      0     7ms       0   372us     1us     1us     8us     1us
# Rows sent      1   4.32k       1       1       1       1       0       1
# Rows examine  36   4.10M     752   1.13k  972.16   1.09k  118.83  918.49
# Query size     1 418.79k      97      97      97      97       0      97
# String:
# Databases    isuride
# Hosts        ip-192-168-0-11.ap-northeast-1.compute.inter...
# Users        isucon
# Query_time distribution
#   1us
#  10us
# 100us  ########################
#   1ms  ################################################################
#  10ms  ##
# 100ms
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isuride` LIKE 'rides'\G
#    SHOW CREATE TABLE `isuride`.`rides`\G
# EXPLAIN /*!50100 PARTITIONS*/
SELECT * FROM rides WHERE user_id = '01JEP4SKPS4AB7SD9VCE9DQ0TX' ORDER BY created_at DESC LIMIT 1\G

# Query 6: 602.94 QPS, 0.16x concurrency, ID 0xD8DAD8AC6EDE2238F17AC39B0009258F at byte 84070303
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.00
# Time range: 2024-12-09T16:41:22 to 2024-12-09T16:42:27
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count         14   39191
# Exec time      5     10s    98us    16ms   259us   725us   456us   159us
# Lock time      4    62ms       0     1ms     1us     1us    14us     1us
# Rows sent     10  37.91k       0       1    0.99    0.99    0.10    0.99
# Rows examine   0  37.91k       0       1    0.99    0.99    0.10    0.99
# Query size    15   3.66M      98      98      98      98       0      98
# String:
# Databases    isuride
# Hosts        ip-192-168-0-11.ap-northeast-1.compute.inter...
# Users        isucon
# Query_time distribution
#   1us
#  10us  #
# 100us  ################################################################
#   1ms  ##
#  10ms  #
# 100ms
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isuride` LIKE 'rides'\G
#    SHOW CREATE TABLE `isuride`.`rides`\G
# EXPLAIN /*!50100 PARTITIONS*/
SELECT * FROM rides WHERE chair_id = '01JEP4R04PGX7RK6YZ5RD63JED' ORDER BY updated_at DESC LIMIT 1\G

# Query 7: 92.02 QPS, 0.10x concurrency, ID 0xA3B0C1486434871B20F519E77C3FD9E6 at byte 73995925
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.00
# Time range: 2024-12-09T16:41:22 to 2024-12-09T16:42:27
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          2    5981
# Exec time      3      6s   256us    15ms     1ms     3ms     1ms   596us
# Lock time      0     9ms       0     1ms     1us     1us    19us     1us
# Rows sent      0   3.31k       0       1    0.57    0.99    0.49    0.99
# Rows examine  34   3.80M     528     767  665.73  755.64   68.83  652.75
# Query size     1 385.49k      66      66      66      66       0      66
# String:
# Databases    isuride
# Hosts        ip-192-168-0-11.ap-northeast-1.compute.inter...
# Users        isucon
# Query_time distribution
#   1us
#  10us
# 100us  ################################################################
#   1ms  ######################
#  10ms  #
# 100ms
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isuride` LIKE 'coupons'\G
#    SHOW CREATE TABLE `isuride`.`coupons`\G
# EXPLAIN /*!50100 PARTITIONS*/
SELECT * FROM coupons WHERE used_by = '01JEP4SERK5TXVYFQVEQB75M74'\G

# Query 8: 149.97 QPS, 0.04x concurrency, ID 0x9C1BE9A08595D62A208963461F89E6D8 at byte 74771067
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.00
# Time range: 2024-12-09T16:41:24 to 2024-12-09T16:42:27
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          3    9448
# Exec time      1      3s   106us    15ms   273us   690us   496us   176us
# Lock time      0    11ms       0   379us     1us     1us     5us     1us
# Rows sent     12  46.39k       1       6    5.03    5.75    1.57    5.75
# Rows examine   0  46.40k       1       6    5.03    5.75    1.57    5.75
# Query size     3 848.84k      92      92      92      92       0      92
# String:
# Databases    isuride
# Hosts        ip-192-168-0-11.ap-northeast-1.compute.inter...
# Users        isucon
# Query_time distribution
#   1us
#  10us
# 100us  ################################################################
#   1ms  ##
#  10ms  #
# 100ms
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isuride` LIKE 'ride_statuses'\G
#    SHOW CREATE TABLE `isuride`.`ride_statuses`\G
# EXPLAIN /*!50100 PARTITIONS*/
SELECT * FROM ride_statuses WHERE ride_id = '01JEP4SH8CGNPDYQPPDCDTMQ0B' ORDER BY created_at\G

# Query 9: 1.52 QPS, 0.03x concurrency, ID 0xDA53740BFC6EFE80C82E6DACE52D86FD at byte 84113810
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.03
# Time range: 2024-12-09T16:41:23 to 2024-12-09T16:42:23
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          0      91
# Exec time      0      2s     1ms   120ms    19ms    65ms    24ms     8ms
# Lock time      0     1ms     1us     1ms    13us     2us   106us     1us
# Rows sent      1   4.15k       0     100   46.69   92.72   25.58   36.69
# Rows examine   0   4.15k       0     100   46.69   92.72   25.58   36.69
# Query size     0 161.55k     873   3.43k   1.78k   3.19k  821.75   1.46k
# String:
# Databases    isuride
# Hosts        ip-192-168-0-11.ap-northeast-1.compute.inter...
# Users        isucon
# Query_time distribution
#   1us
#  10us
# 100us
#   1ms  ################################################################
#  10ms  ################################################
# 100ms  #
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isuride` LIKE 'rides'\G
#    SHOW CREATE TABLE `isuride`.`rides`\G
#    SHOW TABLE STATUS FROM `isuride` LIKE 'ride_statuses'\G
#    SHOW CREATE TABLE `isuride`.`ride_statuses`\G
# EXPLAIN /*!50100 PARTITIONS*/
SELECT chair_id, COUNT(*) = 0 AS is_empty FROM (SELECT chair_id, COUNT(chair_sent_at) = 6 AS completed FROM rides AS r LEFT JOIN ride_statuses AS rs ON rs.ride_id = r.id WHERE r.chair_id IN ('01JEP4QZV4CAG39WCWBETHYD99', '01JEP4QZVETDB2JGAD4EG6VGBM', '01JEP4QZVR1FDB78PTKPEY8E0D', '01JEP4QZW4BTYN1111E6CZFHTR', '01JEP4QZXMT80475PV4F7AYDY8', '01JEP4QZXY7MFP12K65R3AYS9H', '01JEP4QZY8CX5D17FEFWC851D4', '01JEP4QZYHR0S37F08PS4TTA00', '01JEP4QZZVW70547BZTDBGQWTP', '01JEP4R00719NGF0QFXETZBG85', '01JEP4R00H14PGECTXD8A1P8X7', '01JEP4R00WMEQH2T0Z3V7E9DF4', '01JEP4R02306YF6JRSCMK2DY5M', '01JEP4R02G9QG3V3VBXSXWZAYC', '01JEP4R02TB0GQ3HBGWVET8WXS', '01JEP4R0348EWGE221RTDS478P', '01JEP4R04AQPCBBAK6H5XXW3W9', '01JEP4R04PGX7RK6YZ5RD63JED', '01JEP4R051YN5JXRXH5XAE2ZNS', '01JEP4R05B42YD2P1B75M655TN'/*... omitted 82 items ...*/) GROUP BY ride_id, chair_id) is_completed WHERE completed = FALSE GROUP BY chair_id\G

# Query 10: 2.73 QPS, 0.03x concurrency, ID 0x81419520B08C9688CC6AB9C44F11C9E6 at byte 3522068
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.01
# Time range: 2024-12-09T16:41:22 to 2024-12-09T16:42:22
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          0     164
# Exec time      0      2s     5ms    62ms    11ms    14ms     8ms     9ms
# Lock time      0   268us     1us    18us     1us     1us     1us     1us
# Rows sent      0       0       0       0       0       0       0       0
# Rows examine   0       0       0       0       0       0       0       0
# Query size     0  29.63k     185     185     185     185       0     185
# String:
# Databases    isuride
# Hosts        ip-192-168-0-11.ap-northeast-1.compute.inter...
# Users        isucon
# Query_time distribution
#   1us
#  10us
# 100us
#   1ms  ################################################################
#  10ms  ################################################
# 100ms
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isuride` LIKE 'payment_tokens'\G
#    SHOW CREATE TABLE `isuride`.`payment_tokens`\G
INSERT INTO payment_tokens (user_id, token) VALUES ('01JEP4R0A67AM9B46FYSQPPCK8', 'aaLUkrciJXTnYBkIArWJuwAAsdcHOQIFMiKPxjxBJoBpVipjvhIMJVjpYyIEVMUIChJcvDpPNWGACABDdwfYgJlyGqPuPRmVLJyZ')\G

# Query 11: 11.84 QPS, 0.02x concurrency, ID 0xFAB1755BD4E9CE87C5FE1E9D6E43EC40 at byte 61233702
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.00
# Time range: 2024-12-09T16:41:22 to 2024-12-09T16:42:23
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          0     722
# Exec time      0      2s   488us    17ms     2ms     7ms     2ms     1ms
# Lock time      0   854us       0    26us     1us     1us     1us     1us
# Rows sent      0     846       0       7    1.17    3.89    1.33    0.99
# Rows examine   5 636.23k     750   1.12k  902.35   1.09k  114.32  833.10
# Query size     0  62.75k      89      89      89      89       0      89
# String:
# Databases    isuride
# Hosts        ip-192-168-0-11.ap-northeast-1.compute.inter...
# Users        isucon
# Query_time distribution
#   1us
#  10us
# 100us  ######################################
#   1ms  ################################################################
#  10ms  #
# 100ms
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isuride` LIKE 'rides'\G
#    SHOW CREATE TABLE `isuride`.`rides`\G
# EXPLAIN /*!50100 PARTITIONS*/
SELECT * FROM rides WHERE user_id = '01JEP4RWV504BBTNE2J6DF0XY7' ORDER BY created_at DESC\G

# Query 12: 69.08 QPS, 0.02x concurrency, ID 0x5CAA8168B7B8D221E74FB978834E34B2 at byte 73489663
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.00
# Time range: 2024-12-09T16:41:23 to 2024-12-09T16:42:27
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          1    4421
# Exec time      0      1s   126us    23ms   337us   972us   756us   185us
# Lock time      0     5ms       0   227us     1us     1us     4us     1us
# Rows sent      0   2.02k       0       1    0.47    0.99    0.50       0
# Rows examine   0  10.76k       1       6    2.49    5.75    1.58    1.96
# Query size     2 552.62k     128     128     128     128       0     128
# String:
# Databases    isuride
# Hosts        ip-192-168-0-11.ap-northeast-1.compute.inter...
# Users        isucon
# Query_time distribution
#   1us
#  10us
# 100us  ################################################################
#   1ms  ###
#  10ms  #
# 100ms
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isuride` LIKE 'ride_statuses'\G
#    SHOW CREATE TABLE `isuride`.`ride_statuses`\G
# EXPLAIN /*!50100 PARTITIONS*/
SELECT * FROM ride_statuses WHERE ride_id = '01JEP4SHRKD1T8EBXP6TQWNYZZ' AND app_sent_at IS NULL ORDER BY created_at ASC LIMIT 1\G

# Query 13: 726.15 QPS, 0.02x concurrency, ID 0x9E2DA589A20EC24C34E11DDE0FBF5564 at byte 87645061
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.00
# Time range: 2024-12-09T16:41:22 to 2024-12-09T16:42:27
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count         16   47200
# Exec time      0      1s     9us     5ms    30us    38us    84us    22us
# Lock time      0       0       0       0       0       0       0       0
# Rows sent      0       0       0       0       0       0       0       0
# Rows examine   0       0       0       0       0       0       0       0
# Query size     3 783.59k      17      17      17      17       0      17
# String:
# Databases    isuride
# Hosts        ip-192-168-0-11.ap-northeast-1.compute.inter...
# Users        isucon
# Query_time distribution
#   1us  #
#  10us  ################################################################
# 100us  #
#   1ms  #
#  10ms
# 100ms
#    1s
#  10s+
START TRANSACTION\G

# Query 14: 110 QPS, 0.02x concurrency, ID 0xDB862F633DEA18D750C8371D2E984DDF at byte 3498392
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.01
# Time range: 2024-12-09T16:41:22 to 2024-12-09T16:42:27
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          2    7150
# Exec time      0      1s    80us    51ms   200us   204us     1ms   119us
# Lock time      0    11ms     1us    62us     1us     1us     1us     1us
# Rows sent      1   6.98k       1       1       1       1       0       1
# Rows examine   0   6.98k       1       1       1       1       0       1
# Query size     3 747.12k     107     107     107     107       0     107
# String:
# Databases    isuride
# Hosts        ip-192-168-0-11.ap-northeast-1.compute.inter...
# Users        isucon
# Query_time distribution
#   1us
#  10us  ####
# 100us  ################################################################
#   1ms  #
#  10ms  #
# 100ms
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isuride` LIKE 'users'\G
#    SHOW CREATE TABLE `isuride`.`users`\G
# EXPLAIN /*!50100 PARTITIONS*/
SELECT * FROM users WHERE access_token = 'cc77ff8e5dc0a4802367500114a376a1dd7aa607a47a60cbb3075b7072073525'\G

# Query 15: 11.98 QPS, 0.02x concurrency, ID 0xA8AB6DA329E391A212D0E51BED4B3EDE at byte 32316841
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.00
# Time range: 2024-12-09T16:41:23 to 2024-12-09T16:42:23
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          0     719
# Exec time      0      1s   393us    10ms     2ms     5ms     2ms   925us
# Lock time      0   805us       0     7us     1us     1us       0     1us
# Rows sent      9  35.03k      20     108   49.88   97.36   28.59   36.69
# Rows examine   3 386.17k     520     612  549.98  592.07   30.11  511.45
# Query size     0  30.19k      43      43      43      43       0      43
# String:
# Databases    isuride
# Hosts        ip-192-168-0-11.ap-northeast-1.compute.inter...
# Users        isucon
# Query_time distribution
#   1us
#  10us
# 100us  ################################################################
#   1ms  #######################################################
#  10ms  #
# 100ms
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isuride` LIKE 'chairs'\G
#    SHOW CREATE TABLE `isuride`.`chairs`\G
# EXPLAIN /*!50100 PARTITIONS*/
SELECT * FROM chairs WHERE is_active = true\G

# Query 16: 1.80 QPS, 0.02x concurrency, ID 0xF25808F84250C9EECEE9DFF5FC25984B at byte 3518107
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.00
# Time range: 2024-12-09T16:41:22 to 2024-12-09T16:42:22
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          0     108
# Exec time      0      1s     5ms    59ms    11ms    14ms     5ms    10ms
# Lock time      0   202us     1us    21us     1us     1us     2us     1us
# Rows sent      0       0       0       0       0       0       0       0
# Rows examine   0     108       1       1       1       1       0       1
# Query size     0   7.49k      71      71      71      71       0      71
# String:
# Databases    isuride
# Hosts        ip-192-168-0-11.ap-northeast-1.compute.inter...
# Users        isucon
# Query_time distribution
#   1us
#  10us
# 100us
#   1ms  #############################################
#  10ms  ################################################################
# 100ms
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isuride` LIKE 'chairs'\G
#    SHOW CREATE TABLE `isuride`.`chairs`\G
UPDATE chairs SET is_active = 1 WHERE id = '01JEP4R04PGX7RK6YZ5RD63JED'\G
# Converted for EXPLAIN
# EXPLAIN /*!50100 PARTITIONS*/
select  is_active = 1 from chairs where  id = '01JEP4R04PGX7RK6YZ5RD63JED'\G

# Query 17: 28.95 QPS, 0.02x concurrency, ID 0x0956F622BA3E7E31F3E1527A61FD7F1E at byte 84997927
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.00
# Time range: 2024-12-09T16:41:22 to 2024-12-09T16:42:22
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          0    1737
# Exec time      0      1s   117us    11ms   636us     2ms   872us   332us
# Lock time      0     4ms       0     1ms     2us     1us    30us     1us
# Rows sent      0   3.35k       0       8    1.98    4.96    1.70    1.96
# Rows examine   0  27.83k       0      59   16.41   40.45   12.19   13.83
# Query size     1 412.91k     240     244  243.42  234.30       0  234.30
# String:
# Databases    isuride
# Hosts        ip-192-168-0-11.ap-northeast-1.compute.inter...
# Users        isucon
# Query_time distribution
#   1us
#  10us
# 100us  ################################################################
#   1ms  ###########
#  10ms  #
# 100ms
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isuride` LIKE 'rides'\G
#    SHOW CREATE TABLE `isuride`.`rides`\G
#    SHOW TABLE STATUS FROM `isuride` LIKE 'ride_statuses'\G
#    SHOW CREATE TABLE `isuride`.`ride_statuses`\G
# EXPLAIN /*!50100 PARTITIONS*/
SELECT rides.* FROM rides JOIN ride_statuses ON rides.id = ride_statuses.ride_id WHERE chair_id = '01JEP4SAYRH5CHZ44Q52ZAQ7NR' AND status = 'COMPLETED' AND updated_at BETWEEN '1970-01-01' AND '2024-12-09 16:42:19.854' + INTERVAL 999 MICROSECOND\G

# Query 18: 34.08 QPS, 0.02x concurrency, ID 0xF7AA78CED19E80953A6C54054F4089B2 at byte 79162558
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.00
# Time range: 2024-12-09T16:41:23 to 2024-12-09T16:42:24
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          0    2079
# Exec time      0      1s   138us    25ms   519us     2ms     1ms   214us
# Lock time     10   153ms       0    18ms    73us     1us   844us     1us
# Rows sent      0       0       0       0       0       0       0       0
# Rows examine   0   2.03k       1       1       1       1       0       1
# Query size     0 205.06k     101     101     101     101       0     101
# String:
# Databases    isuride
# Hosts        ip-192-168-0-11.ap-northeast-1.compute.inter...
# Users        isucon
# Query_time distribution
#   1us
#  10us
# 100us  ################################################################
#   1ms  #####
#  10ms  #
# 100ms
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isuride` LIKE 'ride_statuses'\G
#    SHOW CREATE TABLE `isuride`.`ride_statuses`\G
UPDATE ride_statuses SET chair_sent_at = CURRENT_TIMESTAMP(6) WHERE id = '01JEP4SNR7M6KYDTBDPSF0N29Y'\G
# Converted for EXPLAIN
# EXPLAIN /*!50100 PARTITIONS*/
select  chair_sent_at = CURRENT_TIMESTAMP(6) from ride_statuses where  id = '01JEP4SNR7M6KYDTBDPSF0N29Y'\G

# Query 19: 50.80 QPS, 0.02x concurrency, ID 0x780A355BC10F6DC5B57B4BBCC1A9703E at byte 78917662
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.00
# Time range: 2024-12-09T16:41:23 to 2024-12-09T16:42:27
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          1    3251
# Exec time      0      1s   116us    19ms   324us   839us   837us   176us
# Lock time      0     5ms       0     1ms     1us     1us    19us     1us
# Rows sent      0   2.03k       0       1    0.64    0.99    0.48    0.99
# Rows examine   0   2.14k       0       2    0.68    0.99    0.48    0.99
# Query size     1 412.72k     130     130     130     130       0     130
# String:
# Databases    isuride
# Hosts        ip-192-168-0-11.ap-northeast-1.compute.inter...
# Users        isucon
# Query_time distribution
#   1us
#  10us
# 100us  ################################################################
#   1ms  ##
#  10ms  #
# 100ms
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isuride` LIKE 'ride_statuses'\G
#    SHOW CREATE TABLE `isuride`.`ride_statuses`\G
# EXPLAIN /*!50100 PARTITIONS*/
SELECT * FROM ride_statuses WHERE ride_id = '01JEP4SGCJT8JQTN7CP6DQFMEC' AND chair_sent_at IS NULL ORDER BY created_at ASC LIMIT 1\G

# Query 20: 33.90 QPS, 0.02x concurrency, ID 0xE7AB668DE937457E0A7E2ACD36EEE101 at byte 73130399
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.01
# Time range: 2024-12-09T16:41:23 to 2024-12-09T16:42:24
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          0    2068
# Exec time      0      1s   116us    37ms   498us     1ms     2ms   176us
# Lock time     19   293ms       0    37ms   141us     1us     2ms     1us
# Rows sent      0       0       0       0       0       0       0       0
# Rows examine   0   2.02k       1       1       1       1       0       1
# Query size     0 199.93k      99      99      99      99       0      99
# String:
# Databases    isuride
# Hosts        ip-192-168-0-11.ap-northeast-1.compute.inter...
# Users        isucon
# Query_time distribution
#   1us
#  10us
# 100us  ################################################################
#   1ms  ####
#  10ms  #
# 100ms
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isuride` LIKE 'ride_statuses'\G
#    SHOW CREATE TABLE `isuride`.`ride_statuses`\G
UPDATE ride_statuses SET app_sent_at = CURRENT_TIMESTAMP(6) WHERE id = '01JEP4SJVJSAA26M38EY683DKN'\G
# Converted for EXPLAIN
# EXPLAIN /*!50100 PARTITIONS*/
select  app_sent_at = CURRENT_TIMESTAMP(6) from ride_statuses where  id = '01JEP4SJVJSAA26M38EY683DKN'\G
